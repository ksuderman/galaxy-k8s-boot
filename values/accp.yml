ingress:
  enabled: true
  ingressClassName: ""
  canary:
    enabled: false
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
  - host: ~
    paths:
    - path: /
  path: /

#image:
#  tag: "25.0.1"

jobs:
  rules:
    tpv_rules_local.yml:
      tools:
        toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/.*:
          cores: 16
          mem: 96

resources:
  limits:
    memory: 64G

persistence:
  storageClass: nfs
  size: 20Gi

cvmfs:
  deployPostInstallFix: true
  cvmfscsi:
    cache:
      local:
        enabled: true
        pvc:
          storageClass: nfs
          name: cvmfs-local-cache
      alien:
        enabled: false
        pvc:
          name: cvmfs-alien-cache
    logVerbosityLevel: 5

postgresql:
  persistence:
    storageClass: blockstorage

rabbitmq:
  persistence:
    storageClassName: blockstorage

configs:
  galaxy.yml:
    galaxy:
      require_login: true
      show_welcome_with_login: true
      allow_user_creation: false
      job_metrics:
        - type: core
        - type: cgroup
        - type: cpuinfo
        - type: meminfo
        - type: uname
  job_conf.yml:
    runners:
      k8s:
        k8s_cleanup_job: never
#    tools:
#      - id: toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/.*
#        embed_metadata_in_job: true
#  job_resource_params_conf.xml: |
#      <parameters>
#          <param label="Processors" name="processors" type="integer" min="1" max="62" value="" help="Number of processing cores, 'ppn' value (1-62). Leave blank to use default value." />
#          <param label="Memory" name="mem" type="integer" min="1" max="250" value="" help="Memory size in gigabytes, 'pmem' value (1-250). Leave blank to use default value." />
#          <param label="Wall Time" name="time" type="integer" min="1" max="744" value="" help="Maximum job time in hours, 'walltime' value (1-744). Leave blank to use default value." />
#      </parameters>

extraFileMappings:
  /galaxy/server/static/welcome.html:
    applyToWeb: true
    applyToNginx: true
    content: |
      <!DOCTYPE html>
      <html lang="en">
          <head>
              <meta charset="utf-8" />
              <link rel="stylesheet" href="dist/base.css" type="text/css" />
          </head>
          <body class="m-0">
              <div class="py-4">
                  <div class="container">
                      <div class="row mb-4">
                          <div class="col-md-12">
                              <h2>Welcome to Galaxy on ACCP</h2>
                              <p>
                                  Galaxy is an interactive and workflow analysis
                                  platform providing a graphical user interface
                                  for computational tools. This is your own
                                  Galaxy instance running on the ACCP platform
                                  that you can customize and use for your own
                                  research. You can also add others users to
                                  this Galaxy instance via the ACCP portal.
                              </p>
                          </div>
                      </div>
                  </div>
              </div>
          </body>
      </html>
